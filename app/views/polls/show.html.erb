<p>
  <b>Author:</b>
  <%=h @poll.author %>
</p>

<p>
  <b>Title:</b>
  <%=h @poll.title %>
</p>

<p>
  <b>Created at:</b>
  <%=h @poll.created_at %>
</p>

<p>
  <b>Description:</b>
  <%=h @poll.description %>
</p>

<% form_for @participant do |f| %>
  <%= f.error_messages %>

  <table>
    <tr>
      <th>Name</th>
      <% @choices.each do |choice| %>
        <th><%=h choice.title %></th>
      <% end %>
    </tr>
    <% @participants.each do |participant| %>
      <tr>
        <td><%=h participant.name %></td>
        <%# TODO: handle event, when there are gaps %>
        <% participant.entries.each do |entry| %>
          <td><%=h entry.answer %></td>
        <% end %>
      </tr>
    <% end %>
    <tr>
      <td><%= f.text_field :name %></td>
      <% f.fields_for :entries do |ef| %>
        <td>
          <%= ef.hidden_field :choice_id %>
          <%= ef.check_box :answer %>
        </td>
      <% end %>
      <td><%= f.submit %></td>
    </tr>
    <tr>
      <td>Results</td>
      <% @choices.each do |choice| %>
        <td><%= choice.result.map{|k,v| "#{h k}-#{h v}"}.join("<br />") %></td>
      <% end %>
    </tr>
  </table>

<% end %>
